<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate a LANDIS-II dispersal process on a landscape. — LANDISDisp • LandR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a LANDIS-II dispersal process on a landscape. — LANDISDisp"><meta property="og:description" content='Simulate seed dispersal using user defined function. This is a "receiving pixel" focused
dispersal approach.
It is the "potentially receiving" cell that looks around itself for potential seed sources.
If it finds a single seed source, that passes the probability function described by the
dispersalFn.
If this passes a comparison to a uniform random draw, then the receiving cell is deemed to have
a "successful" dispersal for that species.
This function can therefore only be used for a relatively specific situation
where there is a yes/no returned for each potential receiving cell, i.e., not abundance.
This function is also not cumulative, i.e,. there is no higher abundance of seeds received if
a receiving cell has lots of seed sources around it vs. a single seed source.
The difference will come with a higher probability of successfully receiving a "seed".'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58633549-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58633549-5');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LandR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/PredictiveEcology/LandR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate a LANDIS-II dispersal process on a landscape.</h1>
    <small class="dont-index">Source: <a href="https://github.com/PredictiveEcology/LandR/blob/HEAD/R/seedDispersalLANDIS.R" class="external-link"><code>R/seedDispersalLANDIS.R</code></a></small>
    <div class="hidden name"><code>LANDISDisp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate seed dispersal using user defined function. This is a "receiving pixel" focused
dispersal approach.
It is the "potentially receiving" cell that looks around itself for potential seed sources.
If it finds a single seed source, that passes the probability function described by the
<code>dispersalFn</code>.
If this passes a comparison to a uniform random draw, then the receiving cell is deemed to have
a "successful" dispersal for that species.
This function can therefore only be used for a relatively specific situation
where there is a yes/no returned for each potential receiving cell, i.e., not abundance.
This function is also not cumulative, i.e,. there is no higher abundance of seeds received if
a receiving cell has lots of seed sources around it vs. a single seed source.
The difference will come with a higher probability of successfully receiving a "seed".</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">LANDISDisp</span><span class="op">(</span></span>
<span>  <span class="va">dtSrc</span>,</span>
<span>  <span class="va">dtRcv</span>,</span>
<span>  <span class="va">pixelGroupMap</span>,</span>
<span>  <span class="va">speciesTable</span>,</span>
<span>  dispersalFn <span class="op">=</span> <span class="va">Ward</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  plot.it <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">successionTimestep</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"LandR.verbose"</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dtSrc</dt>
<dd><p>data.table</p></dd>


<dt>dtRcv</dt>
<dd><p>data.table</p></dd>


<dt>pixelGroupMap</dt>
<dd><p>A <code>RasterLayer</code> with pixel values equal to a pixel group
number that corresponds exactly to <code>pixelGroup</code> column in <code>cohortData</code>.</p></dd>


<dt>speciesTable</dt>
<dd><p>A species traits table, with <strong>at least</strong> the following columns:</p><ul><li><p><code>speciesCode</code> an character representation of species;</p></li>
<li><p><code>Area</code> a character of geographical area within a species range for which trait values are relevant;</p></li>
<li><p><code>longevity</code> species longevity in years, <code>sexualmature</code> age in years at sexual maturity;</p></li>
<li><p><code>shadetolerance</code> numeric value between 1-5 of relative shade tolerance (with respect to other species);</p></li>
<li><p><code>seeddistance_eff</code> the "effective" seed dispersal distance;</p></li>
<li><p><code>seeddistance_max</code> a numeric with the maximum seed dispersal distance;</p></li>
<li><p><code>mortalityshape</code> and <code>growthcurve</code>: growth curve shape parameters.
Other columns (e.g. fire-related traits) can also be included depending on LandR modules in use.
Please see the LANDIS-II Biomass Succession Extension v3.2.1 manual (Scheller and Miranda 2015)
for further detail.</p></li>
</ul></dd>


<dt>dispersalFn</dt>
<dd><p>An expression that can take a "dis" argument. See details.
Default is "Ward" (temporarily unused, as it is hard coded inside Rcpp function)</p></dd>


<dt>b</dt>
<dd><p>LANDIS Ward seed dispersal calibration coefficient (set to 0.01 in LANDIS)</p></dd>


<dt>k</dt>
<dd><p>LANDIS Ward seed dispersal the probability that seed will disperse within
the effective distance (e.g., 0.95)</p></dd>


<dt>plot.it</dt>
<dd><p>Deprecated. If TRUE, then plot the raster at every interaction,
so one can watch the <code>LANDISDisp</code> event grow.</p></dd>


<dt>successionTimestep</dt>
<dd><p>The time between successive seed dispersal events.
In LANDIS-II, this is called "Succession Timestep".</p></dd>


<dt>verbose</dt>
<dd><p>Controls message output. Defaults to <code>getOption("LandR.verbose")</code></p></dd>


<dt>...</dt>
<dd><p>Additional parameters. Currently none.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A numeric vector of raster pixel indices, in the same resolution and extent as
<code>seedSrc</code> raster.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>dispersalFn</code> (temporarily unused as code is converted to Rcpp -- the
default <code>dispersalFn</code> is hard coded within the <code>spiralSeedDispersal</code>
function that uses C++) must be an expression that returns a probability
distribution. Because it is a dispersal kernel, it must be a probability
distribution. The expression that can take an argument named "dis" (without
quotes) as this will be calculated internally and represents the distance
from the initial (receiving) pixel and all active pixels within that cluster
of active pixels. <code>SpaDES</code> includes the <code><a href="WardKernel.html">Ward()</a></code> kernel as
defined in the LANDIS-II documentation.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Eliot McIntire</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://googledrive.tidyverse.org" class="external-link">"googledrive"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">seed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1e6</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># keep this here for interactive testing with a larger raster</span></span></span>
<span class="r-in"><span>  <span class="va">rasterTemplate</span> <span class="op">&lt;-</span> <span class="fu">LandR</span><span class="fu">:::</span><span class="fu"><a href="rasterRead.html">rasterRead</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2500</span>, <span class="fl">0</span>, <span class="fl">2500</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># make a pixelGroupMap</span></span></span>
<span class="r-in"><span>  <span class="va">pgs</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="co"># make even just because of approach below requires even</span></span></span>
<span class="r-in"><span>  <span class="va">pixelGroupMap</span> <span class="op">&lt;-</span> <span class="fu">SpaDES.tools</span><span class="fu">::</span><span class="fu"><a href="https://spades-tools.predictiveecology.org/reference/randomPolygons.html" class="external-link">randomPolygons</a></span><span class="op">(</span><span class="va">rasterTemplate</span>, numTypes <span class="op">=</span> <span class="va">pgs</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pixelGroupMap</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span> <span class="co"># emulate a mask at the start</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Make a receive pixels table -- need pixelGroup and species</span></span></span>
<span class="r-in"><span>  <span class="va">nSpecies</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>  <span class="va">maxNSpeciesPerPixel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">5</span>, <span class="va">nSpecies</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rcvSpByPG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">pgs</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pg</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>speciesCode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">nSpecies</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">maxNSpeciesPerPixel</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">seedReceive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">rcvSpByPG</span>, idcol <span class="op">=</span> <span class="st">"pixelGroup"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Make a source pixels table -- need pixelGroup and species</span></span></span>
<span class="r-in"><span>  <span class="va">srcSpByPG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">pgs</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pg</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>speciesCode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">nSpecies</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">maxNSpeciesPerPixel</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">seedSource</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">srcSpByPG</span>, idcol <span class="op">=</span> <span class="st">"pixelGroup"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># make source pixels not same pixelGroups as receive</span></span></span>
<span class="r-in"><span>  <span class="va">seedSource</span><span class="op">[</span>, <span class="va">pixelGroup</span> <span class="op">:=</span> <span class="va">pixelGroup</span> <span class="op">+</span> <span class="va">pgs</span> <span class="op">/</span> <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Get a species table -- if using in Canada, can use this</span></span></span>
<span class="r-in"><span>  <span class="va">speciesTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="speciesTable.html">getSpeciesTable</a></span><span class="op">(</span>dPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">speciesTable</span> <span class="op">&lt;-</span> <span class="va">speciesTable</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"BSW"</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">speciesTable</span><span class="op">[</span>, <span class="va">speciesCode</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">LandisCode</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">speciesTable</span><span class="op">[</span>, <span class="va">seeddistance_eff</span> <span class="op">:=</span> <span class="va">SeedEffDist</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">speciesTable</span><span class="op">[</span>, <span class="va">seeddistance_max</span> <span class="op">:=</span> <span class="va">SeedMaxDist</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">speciesTable</span> <span class="op">&lt;-</span> <span class="va">speciesTable</span></span></span>
<span class="r-in"><span>  <span class="va">speciesTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">speciesTable</span><span class="op">)</span><span class="op">[</span>, <span class="va">speciesCode</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">LandisCode</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">seedReceiveFull</span> <span class="op">&lt;-</span> <span class="va">speciesTable</span><span class="op">[</span><span class="va">seedReceive</span>, on <span class="op">=</span> <span class="st">"speciesCode"</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">LANDISDisp</span><span class="op">(</span></span></span>
<span class="r-in"><span>    dtRcv <span class="op">=</span> <span class="va">seedReceiveFull</span>, plot.it <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    dtSrc <span class="op">=</span> <span class="va">seedSource</span>,</span></span>
<span class="r-in"><span>    speciesTable <span class="op">=</span> <span class="va">speciesTable</span>,</span></span>
<span class="r-in"><span>    <span class="va">pixelGroupMap</span>,</span></span>
<span class="r-in"><span>    verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    successionTimestep <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Summarize</span></span></span>
<span class="r-in"><span>  <span class="va">output</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="va">speciesCode</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## Plot the maps</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://quickplot.predictiveecology.org" class="external-link">quickPlot</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://quickplot.predictiveecology.org/reference/clearPlot.html" class="external-link">clearPlot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">spMap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">spMap</span><span class="op">$</span><span class="va">pixelGroupMap</span> <span class="op">&lt;-</span> <span class="va">pixelGroupMap</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span> <span class="op">(</span><span class="va">sppp</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">speciesCode</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">spppChar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sp_"</span>, <span class="va">sppp</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">spMap</span><span class="op">[[</span><span class="va">spppChar</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">LandR</span><span class="fu">:::</span><span class="fu"><a href="rasterRead.html">rasterRead</a></span><span class="op">(</span><span class="va">pixelGroupMap</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">seedSource</span><span class="op">[</span><span class="va">speciesCode</span> <span class="op">==</span> <span class="va">sppp</span><span class="op">]</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pixelGroup"</span>, <span class="st">"speciesCode"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">spMap</span><span class="op">[[</span><span class="va">spppChar</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">pixelGroupMap</span><span class="op">[</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ss</span><span class="op">$</span><span class="va">pixelGroup</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>      <span class="va">receivable</span> <span class="op">&lt;-</span> <span class="fu">LandR</span><span class="fu">:::</span><span class="fu"><a href="rasterRead.html">rasterRead</a></span><span class="op">(</span><span class="va">pixelGroupMap</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">srf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">seedReceiveFull</span><span class="op">[</span><span class="va">speciesCode</span> <span class="op">==</span> <span class="va">sppp</span><span class="op">]</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pixelGroup"</span>, <span class="st">"speciesCode"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">receivable</span><span class="op">[</span><span class="va">pixelGroupMap</span><span class="op">[</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">srf</span><span class="op">$</span><span class="va">pixelGroup</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>      <span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pixelGroupMap</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">src</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">spMap</span><span class="op">[[</span><span class="va">spppChar</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">recvable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">receivable</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">rcvd</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">[</span><span class="va">speciesCode</span> <span class="op">==</span> <span class="va">sppp</span><span class="op">]</span><span class="op">$</span><span class="va">pixelIndex</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>      <span class="va">spMap</span><span class="op">[[</span><span class="va">spppChar</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">forest</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>      <span class="va">spMap</span><span class="op">[[</span><span class="va">spppChar</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">recvable</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>      <span class="va">spMap</span><span class="op">[[</span><span class="va">spppChar</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">src</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>      <span class="va">spMap</span><span class="op">[[</span><span class="va">spppChar</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">rcvd</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>      <span class="va">spMap</span><span class="op">[[</span><span class="va">spppChar</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">src</span>, <span class="va">rcvd</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">spMap</span><span class="op">[[</span><span class="va">spppChar</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>                                              type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OtherForest"</span>, <span class="st">"Source"</span>, <span class="st">"Didn't receive"</span>,</span></span>
<span class="r-in"><span>                                                       <span class="st">"Received"</span>, <span class="st">"Src&amp;Rcvd"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://quickplot.predictiveecology.org/reference/Plot.html" class="external-link">Plot</a></span><span class="op">(</span><span class="va">spMap</span>, cols <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># A summary</span></span></span>
<span class="r-in"><span>    <span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu">rast</span><span class="op">(</span><span class="va">spMap</span><span class="op">)</span><span class="op">[[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fl">2</span>, <span class="va">tabulate</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">rr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">spMap</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="st">"type"</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NROW</a></span><span class="op">(</span><span class="va">rr</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="co"># next line only works if there are some places that are both source and potential to receive</span></span></span>
<span class="r-in"><span>    <span class="co"># rr &lt;- rbind(rr, propSrcRcved = round(rr[5,]/ (rr[5,]+rr[2,]), 2))</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: googledrive</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">No cachePath supplied and getOption('reproducible.cachePath') is</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">  inside a temporary directory;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">  this will not persist across R</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">  sessions.</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;"> Running `prepInputs`</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">  Running `preProcess`</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">   Preparing: speciesTraits.csv</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">   ...downloading...</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">   Downloading</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">     https://raw.githubusercontent.com/dcyr/LANDIS-II_IA_generalUseFiles/master/speciesTraits.csv</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">     ...</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">   Hardlinked version of file(s) created:</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">   ... no copy/copies made.</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">   alsoExtract is unspecified; assuming that all files must be</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">     extracted</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">   Appending checksums to CHECKSUMS.txt. If you see this message</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">     repeatedly, you can specify targetFile (and optionally alsoExtract)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">     so it knows what to look for.</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">  Running `process` (i.e., loading file into R)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">   targetFile located at /tmp/RtmpNYXAQX/speciesTraits.csv</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">   Loading object into R</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">   Saved! Cache file: f0e218d45c531975.rds; fn:</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">     </span><span style="color: #BB0000;">data.table::fread</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Saved! Cache file: 24152dca45e6356c.rds; fn: </span><span style="color: #BB0000;">prepInputs</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Eliot J B McIntire, Alex M Chubaty, Ceres Barros, Ian M S Eddy.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

